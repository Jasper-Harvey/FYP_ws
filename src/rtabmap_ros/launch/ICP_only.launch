
<launch>

  <!-- We test here ICP odometry using a guess from visual odometry -->
  
  <arg name="pm"      default="false"/>
  <arg name="nodelet" default="false"/>

  <node pkg="rtabmap_ros" type="icp_odometry" name="icp_odometry" output="screen">
    <remap from="scan_cloud"      to="/baraja_lidar_1/sensorhead_11"/>

    <param name="frame_id"        type="string" value="sensorhead_11"/>   
    <param name="scan_normal_k"   type="int" value="10"/>   
    
    <param name="Icp/PointToPlane"  type="string" value="true"/>
    <param name="Icp/VoxelSize"     type="string" value="0.3"/>
    <param name="Icp/PM"            type="string" value="$(arg pm)"/>
    <param name="Icp/PMOutlierRatio" type="string" value="0.65"/>
    <param name="Odom/GuessMotion"  type="string" value="true"/>
    <param name="Odom/ResetCountdown"  type="string" value="1"/>
  </node>
  
  
  <!-- We just use odometry without rtabmap node, so set a static /map->/odom 
       transform so that rviz config below works out-of-the-box -->
  <node pkg="tf" type="static_transform_publisher" name="map_odom"
        args="0 0 0 0 0 0 map odom 100" />  
  
  <!-- Visualization RVIZ -->
  <node pkg="rviz" type="rviz" name="rviz" args="-d $(find rtabmap_ros)/launch/config/rgbd.rviz"/>
</launch>
